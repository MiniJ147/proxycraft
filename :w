package main

import (
	"log"
	"net"
)

const HIP = "127.0.0.1:25565"
const DEST = "127.0.0.1:25566"

func fail(e error, m string) {
	if e != nil {
		log.Fatal(e, m)
	}
}

func main() {
	mi, e := net.Dial("tcp", DEST)
	fail(e, "minecraft")

	l, e := net.Dial("tcp", HIP)
	fail(e, "proxy")

	go func() {
		buf := make([]byte, 1024)
		for {
			n, e := mi.Read(buf)
			fail(e, "failed read")

			n, e = l.Write(buf[:n])
			fail(e, "failed write")
		}
	}()

	buf := make([]byte, 1024)
	for {
		n, e := l.Read(buf)
		fail(e, "failed read")

		n, e = mi.Write(buf[:n])
		fail(e, "failed write")

	}

}
